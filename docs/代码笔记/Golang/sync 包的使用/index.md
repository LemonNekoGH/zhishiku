# sync 包的使用


sync 包是 go 语言内置的同步包，包括了 Mutex 互斥锁，和 RWMutex 读写锁两个类型

## Mutex 互斥锁

当存在并发数据写入情况时，为了保证数据正确，会需要将写入操作加锁，以防止同时有其它协程在进行写入

适用于读操作后紧接着写操作，并且这种写入可能并发的情况

```Go
count := 0
loc := sync.Mutex{}

for i := 0; i < 1000; i++ {
  go func() {
    loc.Lock()
    count += 1
    loc.Unlock()
  }
}
```


## RWMutex 读写锁

如果读操作比写操作多，而且并不希望读操作会阻塞写操作的情况时使用读写锁

### 误区：写入之前会读取所以也要加读锁

- 当存在读锁时，写锁也会阻塞

- 其它协程在操作时也会尝试加写锁，会被当前的读锁阻塞，所以不用担心其它协程在写之前的读操作不会阻塞
